{"code":"exports.id=0,exports.modules={\"./src/server.js\":function(e,s,o){\"use strict\";o.r(s);var n=o(\"express\"),t=o.n(n),a=o(\"jsonwebtoken\"),r=o.n(a),u=o(\"mongoose\"),i=o.n(u),d=i.a.Schema({email:{type:String,required:!0,unique:!0,match:/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/},password:{type:String,required:!0}}),c=i.a.model(\"User\",d),l=Object(n.Router)();l.get(\"/\",function(e,s){s.json({message:\"I am a server route and can also be hot reloaded!\"})}),l.post(\"/user\",function(e,s,o){var n=e.headers.authorization;void 0!==n?(e.token=n,o()):s.status(403)},function(e,s,o){r.a.verify(e.token,\"secret\",function(e,n){e&&s.sendStatus(403),o()})},function(e,s){new c({email:e.body.email,password:e.body.password}).save().then(function(){s.json({status:200,token:e.token})})}),l.post(\"/login\",function(e,s){c.find({email:e.body.email}).exec().then(function(o){o<1&&s.status(403).json({message:\"user not found\"}),o[0].password==e.body.password?r.a.sign({user:o},\"secret\",function(e,n){n?s.json({token:n}):s.json({user:o})}):s.status(403).json({message:\"auth fail\"})})});var f=l,p=o(\"body-parser\"),h=o.n(p);i.a.connect(\"mongodb://localhost:27017/prueba\",{useNewUrlParser:!0});var m=t()();m.use(function(e,s,o){s.header(\"Access-Control-Allow-Origin\",\"*\"),s.header(\"Access-Control-Allow-Headers\",\"Origin, X-Requested-With, Content-Type, Accept,Authorization\"),s.header(\"Access-Control-Allow-Methods\",\"GET,PUT,POST,DELETE\"),o()}),m.use(h.a.json()),m.use(h.a.urlencoded({extended:!0})),m.use(\"/\",f);s.default=m}};","extractedComments":[]}